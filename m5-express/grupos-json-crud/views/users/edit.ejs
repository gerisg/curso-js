<!DOCTYPE html>
<html lang="en">
<%- include('../partials/head', { title: 'Editar usuario' }) %>
<body>
    <%- include('../partials/header') %>
    <main>
        <div class="container">
            <section>
                <div class="columns is-centered">
                    <div class="column is-6">
                        <h1>Editar usuario</h1>
                        <figure><img class="is-rounded" src="/img/users/<%= user.image %>" alt="" onerror="this.src = 'https://i.pravatar.cc/150?img=2'"></figure>
                        <form action="/users/<%= user && user.id %>?_method=PUT" method="POST" enctype="multipart/form-data">

                            <input type="hidden" name="currentImage" value="<%= user.image %>">
                            <input type="hidden" name="currentPass" value="<%= user.password %>">

                            <div class="field">
                                <label for="firstname">Nombre</label>
                                <div class="control">
                                    <input type="text" name="firstname" value="<%= user && user.firstname %>">
                                </div>
                                <p class="feedback <%= locals.errors && errors.firstname ? 'is-danger' : '' %>">
                                    <%= locals.errors && errors.firstname ? errors.firstname.msg : '' %>
                                </p>
                            </div>

                            <div class="field">
                                <label for="lastname">Apellido</label>
                                <div class="control">
                                    <input type="text" name="lastname" value="<%= user && user.lastname %>">
                                </div>
                                <p class="feedback <%= locals.errors && errors.lastname ? 'is-danger' : '' %>">
                                    <%= locals.errors && errors.lastname ? errors.lastname.msg : '' %>
                                </p>
                            </div>

                            <div class="field">
                                <label for="email">Email</label>
                                <div class="control">
                                    <input type="email" name="email" value="<%= user && user.email %>">
                                </div>
                                <p class="feedback <%= locals.errors && errors.email ? 'is-danger' : '' %>">
                                    <%= locals.errors && errors.email ? errors.email.msg : '' %>
                                </p>
                            </div>

                            <div class="field">
                                <label for="password">Contraseña</label>
                                <div class="control">
                                    <input type="password" name="password">
                                </div>
                                <p class="feedback <%= locals.errors && errors.password ? 'is-danger' : '' %>">
                                    <%= locals.errors && errors.password ? errors.password.msg : '' %>
                                </p>
                            </div>

                            <div class="field">
                                <label for="category">Categoría</label>
                                <div class="control">
                                    <select name="category" name="category">
                                        <option value="">Selecciona una categoría</option>
                                        <option value="0" <%= locals.user && user.category ==  0 ? 'selected' : '' %>>Administrador</option>
                                        <option value="1" <%= locals.user && user.category ==  1 ? 'selected' : '' %>>Usuario</option>
                                    </select>
                                </div>
                                <p class="feedback <%= locals.errors && errors.category ? 'is-danger' : '' %>">
                                    <%= locals.errors && errors.category ? errors.category.msg : '' %>
                                </p>
                            </div>

                            <div class="field">
                                <label for="name">Imagen</label>
                                <div class="control">
                                    <input type="file" name="image">
                                </div>
                                <p class="feedback"></p>
                            </div>

                            <div class="field">
                                <div class="control">
                                    <button type="submit">Guardar usuario</button>
                                </div>
                            </div>

                        </form>  
                    </div>
                </div>
            </section>
        </div>
    </main>
</body>
</html>